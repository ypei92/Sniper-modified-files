# $Id: Makefile 484 2005-06-28 15:56:35Z witchel $

.SUFFIXES: .fig .dvi .ps

VERSION = NoVersionGiven

#all: *.tex bibliography.bib *.sty
all: *.tex bibliography.bib
	rubber -d -o pdf2ps -Wrefs -Wmisc $(name)

osx:
	rm -f $(name).ps $(name).out $(name).pdf
	pdflatex $(name)
	bibtex $(name)
	pdflatex $(name)
	pdflatex $(name)

clean:
	rubber --clean -d -Wrefs -Wmisc $(name)
	rm -f $(name).ps $(name).out $(name).pdf

#----------------------------------------------------------------------
# Source files.  Edit these variables for each new paper.
#----------------------------------------------------------------------

name = main

latex_files = $(name).tex

# Xfig source.
xfig_files = 	

# EPS generated by xfig.  Don't strictly need this to rebuild paper,
# but don't want to clean it.
xfig_eps_files = 	

# EPS files generated somewhere else, i.e., no other way of generating
# them locally.
eps_files =

#----------------------------------------------------------------------
# Shouldn't have to touch anything below here...
#----------------------------------------------------------------------

#----------------------------------------------------------------------
# LaTeX commands.
#----------------------------------------------------------------------

dvi: 
	rubber -Wrefs -Wmisc $(name)

latex_junk = 	$(name).dvi \
		*.aux \
		$(name).log \
		$(name).blg \
		$(name).bbl \
		$(name).toc \
		$(name).synctex.gz \
		$(name).fdb_latexmk \
		psfig.aux

#----------------------------------------------------------------------
# Postscript/PDF generation.
#----------------------------------------------------------------------

pdf: $(name).pdf 
ps: $(name).ps

# DISTILL = distill
# DISTILL_FLAGS = -embedallfonts on -maxsubsetpct 100

#DISTILL = ps2pdf
#DISTILL_FLAGS = -dPDFSETTINGS=/prepress -dEmbedAllFonts=true 

$(name).pdf: *.tex bibliography.bib *.sty
	rubber --pdf -Wrefs -Wmisc $(name)

$(name).ps: *.tex bibliography.bib *.sty 
	rubber --ps -Wrefs -Wmisc $(name)

#	$(DISTILL) $(DISTILL_FLAGS) $(name).ps



#----------------------------------------------------------------------
# HTML generation.
#----------------------------------------------------------------------

LATEX2HTML = hevea
LATEX2HTML_FLAGS = hevea-compat.hva 

html: $(name).ps
	$(LATEX2HTML) $(LATEX2HTML_FLAGS) $(name).tex
	imagen $(name)

#----------------------------------------------------------------------
# Document previewers.
#----------------------------------------------------------------------

x:
	xdvi -s 5 $(name) &

gv: $(name).ps
	gv $(name).ps &

# Garbage files.
junk = $(latex_junk) 

#----------------------------------------------------------------------
# Miscellaneous.
#----------------------------------------------------------------------

count:
	wc $(latex_files)
